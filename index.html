<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Butterfly</title>
<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:black;
  overflow:hidden;
  font-family:Segoe UI, sans-serif;
}
.scene{
  position:relative;
  width:100%;
  height:100%;
}
.butterfly{
  position:absolute;
  width:180px;
  left:50%;
  top:55%;
  transform:translate(-50%,-50%);
  cursor:pointer;
  animation:flap 1.2s infinite ease-in-out;
  transition:all 2s ease;
}
.butterfly.fly{
  top:-40%;
  opacity:0;
}
@keyframes flap{
  0%,100%{transform:translate(-50%,-50%) scale(1);}
  50%{transform:translate(-50%,-50%) scale(1.08);}
}
.text{
  position:absolute;
  width:100%;
  top:45%;
  text-align:center;
  color:white;
  font-size:36px;
  opacity:0;
  transition:opacity 1.5s;
}
canvas{
  position:fixed;
  inset:0;
  pointer-events:none;
}
</style>
</head>

<body>

<canvas id="galaxy"></canvas>
<canvas id="heart"></canvas>

<div class="scene">
  <img id="butterfly" class="butterfly"
  src="data:image/webp;base64,
UklGRk4AAABXRUJQVlA4IEIAAABQAgCdASoQABAAkA4JZQCdADo
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
">

  <div class="text" id="t1">Chạm để bướm bay</div>
  <div class="text" id="t2">Hoàng Phúc</div>
  <div class="text" id="t3">giờ này chưa ngủ</div>
  <div class="text" id="t4">rảnh quá coi tới đây luôn</div>
  <div class="text" id="t5">chúc anh ngủ ngon</div>
</div>

<script>
const texts=[t1,t2,t3,t4,t5];
let i=0;
setTimeout(()=>show(0),3000);
function show(n){
  texts.forEach(t=>t.style.opacity=0);
  texts[n].style.opacity=1;
}

butterfly.onclick=()=>{
  butterfly.classList.add("fly");
  startGalaxy();
  let d=2000;
  for(let i=1;i<texts.length;i++){
    setTimeout(()=>show(i),d);
    d+=2500;
  }
  setTimeout(startHearts,d+2000);
};

/* GALAXY */
const g=galaxy.getContext("2d");
galaxy.width=innerWidth;
galaxy.height=innerHeight;
let stars=[];
function startGalaxy(){
  for(let i=0;i<200;i++){
    stars.push({
      x:Math.random()*galaxy.width,
      y:Math.random()*galaxy.height,
      r:Math.random()*2,
      v:Math.random()*0.7
    });
  }
  (function anim(){
    g.clearRect(0,0,galaxy.width,galaxy.height);
    stars.forEach(s=>{
      g.beginPath();
      g.arc(s.x,s.y,s.r,0,Math.PI*2);
      g.fillStyle="white";
      g.fill();
      s.y+=s.v;
      if(s.y>galaxy.height) s.y=0;
    });
    requestAnimationFrame(anim);
  })();
}

/* HEART */
const h=heart.getContext("2d");
heart.width=innerWidth;
heart.height=innerHeight;
let hearts=[];
function startHearts(){
  setInterval(()=>hearts.push({t:0,s:Math.random()*10+8}),150);
  (function anim(){
    h.clearRect(0,0,heart.width,heart.height);
    hearts.forEach(o=>{
      o.t+=0.05;
      let x=heart.width/2+(16*Math.sin(o.t)**3)*o.s;
      let y=heart.height/2-(13*Math.cos(o.t)-5*Math.cos(2*o.t))*o.s;
      h.beginPath();
      h.arc(x,y,2,0,Math.PI*2);
      h.fillStyle="pink";
      h.fill();
    });
    requestAnimationFrame(anim);
  })();
}
</script>

</body>
</html>
